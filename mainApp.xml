<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<!-- Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *	
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License
-->
	<ModulePrefs title="TwitchTV Hangouts">
		<Require feature="rpc" />
		<Require feature="views" />
		<Require feature="locked-domain" />
	</ModulePrefs>
	<Content type="html"><![CDATA[     
<html>
<body style="background-color:#181818;">

<script src="https://plus.google.com/hangouts/_/api/v1/hangout.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>



<script type="text/javascript">
gapi.hangout.onApiReady.add(function(eventObj){
// Called when we update the stream button
function change_stream() {
  // Get data
  var stream_input= document.getElementById('stream_input');
  // Update data
  var data = {"stream_input": stream_input.value};
  console.log(data);
  gapi.hangout.data.submitDelta(data);
  return false;
}
// Listen for data changes
gapi.hangout.data.onStateChanged(function(event) {
  // Get data we need
  var stream_url= document.getElementById('stream_url');
  var stream_obj= document.getElementById('live_embed_player_flash');
  var stream_chat= document.getElementById('chat_embed');
  console.log("Event Triggered");
  console.log(event);
  //document.getElementById('FrameID').contentWindow.location.reload(true);
  stream_obj.data = "https://twitch.tv/widgets/live_embed_player.swf?channel="+event.state["stream_input"];
  stream_url.value = "hostname=www.twitch.tv&auto_play=true&start_volume=25&channel="+event.state["stream_input"];
  stream_chat.src = "https://twitch.tv/chat/embed?channel="+event.state["stream_input"];
});
});
</script>

<table style="height:100%;width:100%;">
  <col width="80%">
  <col width="20%">
  <tr>
    <td>

      <!-- Video -->
      <object type="application/x-shockwave-flash" height="100%" width="100%" id="live_embed_player_flash" data="" bgcolor="#000000" >
        <param name="allowFullScreen" value="true" />
        <param name="allowScriptAccess" value="always" />
        <param name="allowNetworking" value="all" />
        <param name="movie" value="https://twitch.tv/widgets/live_embed_player.swf" />
        <param name="flashvars" id="stream_url" value="" />
      </object>
    </td>
    <td>
      <!-- Chat -->
      <iframe frameborder="0" scrolling="no" id="chat_embed" src="" height="95%" width="100%"></iframe>
      <!--Stream Input-->
      <input type="text" id="stream_input" />
      <input type="submit" value="Change Stream" onclick="change_stream();" />
    </td>
  </tr>
</table>

</body>
</html>
]]>
</Content>
</Module>

